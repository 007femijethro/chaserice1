<!-- templates/index.html -->
{% extends "base.html" %}

{% block content %}
<!-- Conditional Hero Section -->
{% if session.user_id %}
    <!-- Hero Slideshow Section for Logged-in Members -->
    <section class="hero-slideshow">
        <!-- Slide 1 -->
        <div class="slide active" style="background-image: url('https://www.chaserice.com/cdn/shop/files/eldorabanner.jpg?v=1754668094&width=2000');">
            <div class="slide-content">
                <h1>Welcome Back, {{ session.username }}!</h1>
                <p>Experience the music, feel the energy</p>
                <a href="https://temple.groover.co/chase-rice" target="_blank" class="btn">Listen Now</a>
            </div>
        </div>
        
        <!-- Slide 2 -->
        <div class="slide" style="background-image: url('https://www.chaserice.com/cdn/shop/files/CR-GDW-Banner-update.jpg?v=1741710583&width=2000');">
            <div class="slide-content">
                <h1>New Album Out</h1>
                <p>Featuring the hit single "Drinkin' Beer. Talkin' God. Amen."</p>
                <a href="https://temple.groover.co/chase-rice" target="_blank" class="btn">Discover More</a>
            </div>
        </div>
        
        <!-- Slide 3 -->
        <div class="slide" style="background-image: url('https://www.chaserice.com/cdn/shop/files/Screenshot%202024-07-02%20at%2010.18.06%20AM.png?v=1751469541&width=2000');">
            <div class="slide-content">
                <h1>Tour 2023</h1>
                <p>Coming to a city near you. Don't miss out!</p>
                <a href="{{ url_for('tour') }}" class="btn">View Tour</a>
            </div>
        </div>
        
        <!-- Slide 4 -->
        <div class="slide" style="background-image: url('https://www.chaserice.com/cdn/shop/files/websitebanner.jpg?v=1754667693&width=2000');">
            <div class="slide-content">
                <h1>Exclusive Member Content</h1>
                <p>Bio, Music, Tours, Raffles & More</p>
                <a href="{{ url_for('raffle') }}" class="btn">Enter Raffle</a>
            </div>
        </div>
        
        <!-- Slideshow Controls -->
        <div class="slideshow-controls">
            <div class="slideshow-dot active" data-slide="0"></div>
            <div class="slideshow-dot" data-slide="1"></div>
            <div class="slideshow-dot" data-slide="2"></div>
            <div class="slideshow-dot" data-slide="3"></div>
        </div>
        
        <!-- Navigation Arrows -->
        <div class="slideshow-nav">
            <button id="prev-slide"><i class="fas fa-chevron-left"></i></button>
            <button id="next-slide"><i class="fas fa-chevron-right"></i></button>
        </div>
    </section>
{% else %}
    <!-- Member Counter Section for Non-logged-in Users -->
    <section class="member-counter-hero" style="
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        min-height: 80vh;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        color: white;
        position: relative;
        overflow: hidden;
    ">
        <!-- Background Animation -->
        <div style="
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><circle cx=\"25\" cy=\"25\" r=\"1\" fill=\"%23ffffff\" opacity=\"0.1\"><animate attributeName=\"opacity\" values=\"0.1;0.3;0.1\" dur=\"3s\" repeatCount=\"indefinite\"/></circle><circle cx=\"75\" cy=\"75\" r=\"1\" fill=\"%23ffffff\" opacity=\"0.1\"><animate attributeName=\"opacity\" values=\"0.1;0.3;0.1\" dur=\"4s\" repeatCount=\"indefinite\"/></circle></svg>') repeat;
            animation: float 20s infinite linear;
        "></div>
        
        <div class="container" style="position: relative; z-index: 2;">
            <div style="margin-bottom: 3rem;">
                <i class="fas fa-users" style="font-size: 4rem; color: var(--primary); margin-bottom: 1rem;"></i>
                <h1 style="font-size: 3.5rem; font-weight: bold; margin-bottom: 1rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
                    Join the Chase Rice Fan Community
                </h1>
                <p style="font-size: 1.3rem; opacity: 0.9; margin-bottom: 2rem;">
                    Be part of something special
                </p>
            </div>
            
            <div style="
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                border-radius: 20px;
                padding: 3rem;
                border: 1px solid rgba(255, 255, 255, 0.2);
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                margin-bottom: 3rem;
                max-width: 500px;
                margin-left: auto;
                margin-right: auto;
            ">
                <div style="margin-bottom: 1.5rem;">
                    <p style="font-size: 1.1rem; opacity: 0.8; margin-bottom: 0.5rem;">Current Members</p>
                    <div id="member-counter" style="
                        font-size: 4rem;
                        font-weight: bold;
                        color: var(--primary);
                        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
                        font-family: 'Orbitron', monospace;
                    ">{{ member_count }}</div>
                    <p style="font-size: 0.9rem; opacity: 0.7; margin-top: 0.5rem;">
                        <i class="fas fa-chart-line"></i> Growing every minute!
                    </p>
                </div>
            </div>
            
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                <a href="{{ url_for('member_register') }}" class="btn" style="
                    padding: 1rem 2rem;
                    font-size: 1.2rem;
                    background: linear-gradient(135deg, var(--primary), var(--accent));
                    border: none;
                    border-radius: 50px;
                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
                    transition: all 0.3s ease;
                    text-transform: uppercase;
                    font-weight: bold;
                    letter-spacing: 1px;
                ">
                    <i class="fas fa-user-plus"></i> Join Now
                </a>
                <a href="{{ url_for('member_login') }}" class="btn" style="
                    padding: 1rem 2rem;
                    font-size: 1.2rem;
                    background: transparent;
                    border: 2px solid var(--primary);
                    border-radius: 50px;
                    color: var(--primary);
                    transition: all 0.3s ease;
                    text-transform: uppercase;
                    font-weight: bold;
                    letter-spacing: 1px;
                ">
                    <i class="fas fa-sign-in-alt"></i> Sign In
                </a>
            </div>
            
            <div style="margin-top: 3rem; opacity: 0.8;">
                <p style="margin-bottom: 1rem;">ðŸŽµ <strong>Exclusive Benefits:</strong></p>
                <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; font-size: 0.9rem;">
                    <span><i class="fas fa-music"></i> New Music First</span>
                    <span><i class="fas fa-ticket-alt"></i> Tour Pre-Sales</span>
                    <span><i class="fas fa-trophy"></i> Meet & Greet Raffles</span>
                    <span><i class="fas fa-star"></i> Exclusive Content</span>
                </div>
            </div>
        </div>
    </section>
{% endif %}

<div class="section">
    <div class="container">
        <h2 class="section-title">Latest News</h2>
        <div class="grid">
            <div class="card">
                
                <div class="card-content">
                    <h3 class="card-title">New Album "I Hate Cowboys & All Dogs Go To Hell" Out Now</h3>
                    <p>Chase's latest album featuring hit singles "Key West & Colorado" and "Bench Seat" is available on all streaming platforms.</p>
                    <a href="{{ url_for('music') }}" class="btn">Listen Now</a>
                </div>
            </div>
            
            <div class="card">
                
                <div class="card-content">
                    <h3 class="card-title">2024 "I Hate Cowboys" Tour Announced</h3>
                    <p>The nationwide tour kicks off in January 2024. Tickets are selling fast - don't miss your chance to see Chase live!</p>
                    <a href="{{ url_for('tour') }}" class="btn">View Tour Dates</a>
                </div>
            </div>
            
            <div class="card">
                
                <div class="card-content">
                    <h3 class="card-title">Meet & Greet Winners</h3>
                    <p>Congratulations to our latest winners who got to meet Chase personally! Enter now for your chance.</p>
                    <a href="{{ url_for('winners') }}" class="btn">View Winners</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
    <div class="container">
        <h2 class="section-title" style="color: white;">Featured Music</h2>
        <div class="album-grid">
            <div class="album-card">
                <img src="static/images/album/I Hate Cowboys.jpeg" alt="I Hate Cowboys & All Dogs Go To Hell" class="album-cover">
                <h4>I Hate Cowboys & All Dogs Go To Hell</h4>
                <p>2023 â€¢ Album</p>
                <a href="https://open.spotify.com/album/3ZKz4e5i4zL3T7f2n3sFqR" target="_blank" class="listen-btn">Listen</a>
            </div>
            
            <div class="album-card">
                <img src="static/images/album/The Album.jpeg" alt="The Album" class="album-cover">
                <h4>The Album</h4>
                <p>2021 â€¢ Album</p>
                <a href="https://open.spotify.com/album/4pQjOCQ3eW7K1tZzLg1q6R" target="_blank" class="listen-btn">Listen</a>
            </div>
            
            <div class="album-card">
                <img src="static/images/album/Lambs & Lions.jpeg" alt="Lambs & Lions" class="album-cover">
                <h4>Lambs & Lions</h4>
                <p>2017 â€¢ Album</p>
                <a href="https://open.spotify.com/album/5e5K5l5y5O5q5a5a5a5a5a" target="_blank" class="listen-btn">Listen</a>
            </div>
        </div>
    </div>
</div>

<div class="section">
    <div class="container">
        <h2 class="section-title">Upcoming Events</h2>
        {% if tours %}
            <div class="grid">
                {% for tour in tours %}
                <div class="card">
                    <div class="card-content">
                        <h3 class="card-title">{{ tour.venue }}</h3>
                        <p><i class="fas fa-calendar"></i> {{ tour.date }}</p>
                        <p><i class="fas fa-map-marker-alt"></i> {{ tour.venue }}, {{ tour.city }}, {{ tour.state_or_country }}</p>
                        {% if tour.ticket_url %}
                            <a href="{{ tour.ticket_url }}" target="_blank" class="btn">Get Tickets</a>
                        {% else %}
                            <a href="https://www.chaserice.com/pages/tour" target="_blank" class="btn">Get Tickets</a>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div style="text-align: center; padding: 3rem;">
                <i class="fas fa-calendar-alt" style="font-size: 3rem; color: var(--text-light); margin-bottom: 1rem;"></i>
                <p style="color: var(--text); margin-bottom: 1rem;">No tour dates scheduled yet.</p>
                <p style="color: var(--text-light);">Check back soon for upcoming shows!</p>
            </div>
        {% endif %}
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const slides = document.querySelectorAll('.slide');
    const dots = document.querySelectorAll('.slideshow-dot');
    const prevBtn = document.getElementById('prev-slide');
    const nextBtn = document.getElementById('next-slide');
    let currentSlide = 0;
    const totalSlides = slides.length;

    function showSlide(index) {
        // Hide all slides
        slides.forEach(slide => slide.classList.remove('active'));
        dots.forEach(dot => dot.classList.remove('active'));
        
        // Show current slide
        slides[index].classList.add('active');
        dots[index].classList.add('active');
    }

    function nextSlide() {
        currentSlide = (currentSlide + 1) % totalSlides;
        showSlide(currentSlide);
    }

    function prevSlide() {
        currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
        showSlide(currentSlide);
    }

    // Auto-advance slides (only if slides exist)
    if (slides.length > 0) {
        setInterval(nextSlide, 7000);
    }

    // Navigation buttons
    if (nextBtn) nextBtn.addEventListener('click', nextSlide);
    if (prevBtn) prevBtn.addEventListener('click', prevSlide);

    // Dot navigation
    dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
            currentSlide = index;
            showSlide(currentSlide);
        });
    });

    // Member counter auto-increment functionality
    const memberCounter = document.getElementById('member-counter');
    if (memberCounter) {
        // Auto-increment counter every minute (60000 milliseconds)
        setInterval(function() {
            fetch('/api/increment_counter', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Update the counter display with animation
                    memberCounter.style.transform = 'scale(1.1)';
                    memberCounter.style.transition = 'transform 0.3s ease';
                    memberCounter.textContent = data.new_count;
                    
                    // Reset scale after animation
                    setTimeout(() => {
                        memberCounter.style.transform = 'scale(1)';
                    }, 300);
                }
            })
            .catch(error => {
                console.log('Counter update failed:', error);
            });
        }, 60000); // 60 seconds = 1 minute
    }
});
</script>
{% endblock %}